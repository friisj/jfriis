# Cog

Image generation pipeline tool for organizing and generating images via AI.

## Concept

Cog manages images and their metadata, organized into **series**. Users can upload existing images or generate new ones through **jobs** - sequences of multimodal LLM and image generation calls.

## Core Entities

### Series

A collection of images with shared context.

- **Metadata**: title, description, tags
- **Nesting**: series can contain sub-series
- **Images**: stored on Supabase
- **Jobs**: unlimited jobs per series

### Image

Individual image files with metadata.

- **Source**: uploaded or generated
- **Storage**: Supabase
- **Metadata**: linked to parent series

### Job

A sequence of AI calls to generate images.

- **Base prompt**: shared context for the job
- **Sequence**: ordered list of calls to LLMs or image models
- **Generation**: job structure generated by LLM
- **Editable**: user can modify before running
- **Manual trigger**: user initiates execution
- **Repeatable**: run, edit, run again
- **Deletable**: can delete job but retain outputs

## Workflow

1. **Create series** with title, description, tags
2. **Upload images** or **create job** for generation
3. **LLM generates job** sequence based on prompt
4. **User reviews/edits** the sequence
5. **User triggers** execution
6. **Images generated** and stored in series
7. **Iterate**: edit job, run again, or create new jobs

## AI Integration

Uses existing AI SDK configs and keys:

- **Google Gemini 2.0 Flash** - multimodal understanding, job generation
- **Nano Banana Pro** - image generation via Gemini API

## Routes

- `/cog` - Main page (series list)

## Database Schema

See [`schema.sql`](./schema.sql) for full SQL migration.

| Table | Purpose |
|-------|---------|
| `cog_series` | Series with metadata (title, description, tags), supports nesting |
| `cog_images` | Image records with Supabase storage paths |
| `cog_jobs` | Job definitions with base prompt and status |
| `cog_job_steps` | Individual steps in job sequence (LLM or image gen) |

**Storage**: `cog-images` bucket in Supabase Storage

## Status

Foundation ready for development.

## Future Enhancements

- Advanced job functions (conditional logic, branching)
- Batch operations
- Style transfer between series
- Version history for images
